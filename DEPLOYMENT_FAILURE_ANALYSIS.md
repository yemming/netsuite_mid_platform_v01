# Zeabur éƒ¨ç½²å¤±æ•—åˆ†æå ±å‘Š

## ğŸ“‹ åŸ·è¡Œæ‘˜è¦

åœ¨ 2025å¹´11æœˆ2æ—¥ çš„éƒ¨ç½²éç¨‹ä¸­ï¼Œç¶“æ­·äº† **è¶…é 20 æ¬¡çš„å»ºç½®å¤±æ•—**ï¼Œæœ€çµ‚é€éæš«æ™‚ç¦ç”¨ TypeScript å»ºç½®æª¢æŸ¥æ‰æˆåŠŸéƒ¨ç½²ã€‚æœ¬å ±å‘Šåˆ†æå¤±æ•—çš„æ ¹æœ¬åŸå› ã€æ¶æ§‹å±¤é¢çš„å•é¡Œï¼Œä»¥åŠæ”¹é€²å»ºè­°ã€‚

---

## ğŸ” å•é¡Œçµ±è¨ˆ

### éƒ¨ç½²å˜—è©¦è¨˜éŒ„
- **ç¸½å˜—è©¦æ¬¡æ•¸**: è¶…é 20 æ¬¡
- **å¤±æ•—åŸå› **: 100% ç‚º TypeScript å‹åˆ¥éŒ¯èª¤
- **æœ€çµ‚è§£æ±ºæ–¹æ¡ˆ**: æš«æ™‚ç¦ç”¨ TypeScript å»ºç½®æª¢æŸ¥

### éŒ¯èª¤åˆ†é¡çµ±è¨ˆ
æ ¹æ“šå»ºç½®æ—¥èªŒåˆ†æï¼ŒéŒ¯èª¤ä¸»è¦åˆ†ç‚ºä»¥ä¸‹å¹¾é¡ï¼š

1. **Supabase å‹åˆ¥æ¨æ–·å•é¡Œ** (ç´„ 70%)
   - `Type 'any' is not assignable to parameter of type 'never'`
   - `Property 'id' does not exist on type 'never'`
   - `Unused '@ts-expect-error' directive`

2. **Next.js ç‰¹å®šå•é¡Œ** (ç´„ 20%)
   - `useSearchParams() should be wrapped in a suspense boundary`
   - `Property 'xxx' does not exist on type 'never'`ï¼ˆå¾ Supabase æŸ¥è©¢çµæœï¼‰

3. **ç¬¬ä¸‰æ–¹å¥—ä»¶å‹åˆ¥å•é¡Œ** (ç´„ 10%)
   - `Value of type 'typeof OAuth' is not callable`
   - Edge Functions çš„ Deno ç’°å¢ƒå•é¡Œ

---

## ğŸ—ï¸ æ¶æ§‹å±¤é¢å•é¡Œåˆ†æ

### 1. **Supabase å‹åˆ¥ç³»çµ±çš„æ ¹æœ¬ç¼ºé™·** âš ï¸ **æœ€åš´é‡**

#### å•é¡Œæè¿°
Supabase çš„ TypeScript å‹åˆ¥æ¨æ–·åœ¨ä»¥ä¸‹æƒ…æ³æœƒå®Œå…¨å¤±æ•ˆï¼š
- ç•¶è³‡æ–™è¡¨çµæ§‹æœªåœ¨ `Database` å‹åˆ¥ä¸­å®Œæ•´å®šç¾©æ™‚
- ä½¿ç”¨ RPC å‡½æ•¸æ™‚ï¼ˆè‡ªå®šç¾©å‡½æ•¸çš„åƒæ•¸å‹åˆ¥ç„¡æ³•æ¨æ–·ï¼‰
- è¤‡é›œçš„æŸ¥è©¢éˆï¼ˆ`.from().select().update()`ï¼‰æœƒå°è‡´å‹åˆ¥é€€åŒ–ç‚º `never`

#### å½±éŸ¿ç¯„åœ
- **42 å€‹æª”æ¡ˆ**ä¸­æœ‰ Supabase æ“ä½œ
- **236 è™•** Supabase å®¢æˆ¶ç«¯èª¿ç”¨
- æ¶‰åŠçš„æ“ä½œï¼š`select`ã€`insert`ã€`update`ã€`upsert`ã€`rpc`

#### å¯¦éš›æ¡ˆä¾‹
```typescript
// âŒ å¤±æ•—ï¼šTypeScript æ¨æ–·ç‚º never
const { data } = await supabase
  .from('suiteql_tables_reference')
  .update(updateData)  // updateData è¢«æ¨æ–·ç‚º never

// âœ… è§£æ±ºæ–¹æ¡ˆï¼ˆworkaroundï¼‰
// @ts-expect-error - Supabase type inference issue
const { data } = await supabase
  .from('suiteql_tables_reference')
  .update(updateData)
```

#### ç‚ºä»€éº¼é›£æï¼Ÿ
1. **å‹åˆ¥å®šç¾©ä¸å®Œæ•´**: `types/supabase.ts` ä¸­ç¼ºå°‘è¨±å¤šè³‡æ–™è¡¨çš„å®Œæ•´å®šç¾©
2. **å‹•æ…‹è¡¨å**: ç„¡æ³•åœ¨ç·¨è­¯æ™‚ç¢ºå®šæ‰€æœ‰å¯èƒ½çš„è¡¨å
3. **Supabase å®¢æˆ¶ç«¯é™åˆ¶**: TypeScript ç„¡æ³•æ¨æ–·å‹•æ…‹ RPC å‡½æ•¸çš„åƒæ•¸å‹åˆ¥

---

### 2. **TypeScript Strict Mode çš„åš´æ ¼æ€§** âš ï¸ **æ¬¡åš´é‡**

#### å•é¡Œæè¿°
å°ˆæ¡ˆå•Ÿç”¨äº† `strict: true`ï¼Œå°è‡´ï¼š
- æ‰€æœ‰å‹åˆ¥éŒ¯èª¤éƒ½æœƒé˜»æ­¢å»ºç½®
- ç„¡æ³•å®¹å¿ä»»ä½•å‹åˆ¥ä¸åŒ¹é…
- Zeabur çš„å»ºç½®ç’°å¢ƒåš´æ ¼åŸ·è¡Œ `tsc --noEmit`

#### å½±éŸ¿
- å³ä½¿é‹è¡Œæ™‚æ²’æœ‰å•é¡Œï¼Œå‹åˆ¥éŒ¯èª¤ä¹Ÿæœƒå°è‡´éƒ¨ç½²å¤±æ•—
- éœ€è¦ä½¿ç”¨å¤§é‡ `@ts-expect-error` æˆ– `as any` çš„ workaround

#### ç‚ºä»€éº¼é›£æï¼Ÿ
1. **ç„¡æ³•é€æ­¥é·ç§»**: å¿…é ˆä¸€æ¬¡æ€§ä¿®å¾©æ‰€æœ‰å‹åˆ¥å•é¡Œ
2. **ç¼ºä¹å½ˆæ€§**: ç„¡æ³•æš«æ™‚å¿½ç•¥æŸäº›å‹åˆ¥éŒ¯èª¤
3. **å»ºç½®ç’°å¢ƒåš´æ ¼**: Zeabur åœ¨ CI/CD ä¸­å¼·åˆ¶åŸ·è¡Œå‹åˆ¥æª¢æŸ¥

---

### 3. **Next.js é–‹ç™¼æ¨¡å¼ vs å»ºç½®æ¨¡å¼çš„å·®ç•°** âš ï¸ **é—œéµç™¼ç¾**

#### å•é¡Œæè¿°
é€™æ˜¯ç‚ºä»€éº¼æœ¬åœ°ä¸æœƒé‡åˆ°å•é¡Œçš„**æ ¸å¿ƒåŸå› **ï¼š

**é–‹ç™¼æ¨¡å¼ (`npm run dev`)**:
- âœ… ä½¿ç”¨ `next dev`ï¼ŒåªåšåŸºæœ¬çš„ç·¨è­¯
- âœ… **ä¸æœƒåš´æ ¼æª¢æŸ¥å‹åˆ¥éŒ¯èª¤**ï¼Œåªæœƒé¡¯ç¤ºè­¦å‘Š
- âœ… å³ä½¿æœ‰ TypeScript éŒ¯èª¤ï¼Œé–‹ç™¼ä¼ºæœå™¨ä»æœƒé‹è¡Œ
- âœ… æ¡ç”¨å¢é‡ç·¨è­¯ï¼Œåªç·¨è­¯ä¿®æ”¹çš„æª”æ¡ˆ

**å»ºç½®æ¨¡å¼ (`npm run build`)**:
- âŒ ä½¿ç”¨ `next build`ï¼ŒåŸ·è¡Œå®Œæ•´çš„å‹åˆ¥æª¢æŸ¥
- âŒ **åš´æ ¼åŸ·è¡Œ `tsc --noEmit` æª¢æŸ¥æ‰€æœ‰å‹åˆ¥éŒ¯èª¤**
- âŒ ä»»ä½•å‹åˆ¥éŒ¯èª¤éƒ½æœƒå°è‡´å»ºç½®å¤±æ•—
- âŒ Zeabur éƒ¨ç½²æ™‚å¿…é ˆåŸ·è¡Œ `npm run build`

#### å¯¦éš›æ¸¬è©¦çµæœ
```bash
# æœ¬åœ°é–‹ç™¼æ¨¡å¼ - å¯ä»¥é‹è¡Œï¼ˆå³ä½¿æœ‰å‹åˆ¥éŒ¯èª¤ï¼‰
npm run dev        # âœ… æˆåŠŸï¼Œåªé¡¯ç¤ºè­¦å‘Š

# æœ¬åœ°å»ºç½®æ¨¡å¼ - ç¾åœ¨å¯ä»¥ï¼ˆå› ç‚ºå·²è¨­å®š ignoreBuildErrorsï¼‰
npm run build      # âœ… æˆåŠŸï¼Œè·³éå‹åˆ¥é©—è­‰

# Zeabur éƒ¨ç½²å»ºç½® - ä¹‹å‰æœƒå¤±æ•—
# ï¼ˆåœ¨åŠ å…¥ ignoreBuildErrors ä¹‹å‰ï¼‰
npm run build      # âŒ å¤±æ•—ï¼ŒTypeScript éŒ¯èª¤é˜»æ­¢å»ºç½®
```

#### ç‚ºä»€éº¼æœ¬åœ°ä¸æœƒé‡åˆ°å•é¡Œï¼Ÿ
1. **é–‹ç™¼æ¨¡å¼å¯¬é¬†**: `next dev` ä¸æœƒå› ç‚ºå‹åˆ¥éŒ¯èª¤è€Œåœæ­¢é‹è¡Œ
2. **å»ºç½®æ¨¡å¼åš´æ ¼**: `next build` æœƒåš´æ ¼æª¢æŸ¥æ‰€æœ‰å‹åˆ¥éŒ¯èª¤
3. **Zeabur å¿…é ˆå»ºç½®**: éƒ¨ç½²æµç¨‹å¿…é ˆåŸ·è¡Œ `npm run build`ï¼Œç„¡æ³•ä½¿ç”¨ `dev` æ¨¡å¼
4. **ç¾åœ¨çš„ç‹€æ…‹**: å·²è¨­å®š `ignoreBuildErrors: true`ï¼Œæ‰€ä»¥æœ¬åœ°å»ºç½®ä¹Ÿèƒ½é€šé

---

### 4. **Zeabur éƒ¨ç½²ç’°å¢ƒçš„é™åˆ¶** âš ï¸ **ä¸­ç­‰**

#### å•é¡Œæè¿°
- Zeabur ä½¿ç”¨ Next.js çš„é è¨­å»ºç½®æµç¨‹
- ç„¡æ³•è‡ªè¨‚å»ºç½®è…³æœ¬ä¾†è·³éå‹åˆ¥æª¢æŸ¥
- æ¯å€‹ commit éƒ½æœƒè§¸ç™¼å®Œæ•´å»ºç½®

#### ç‚ºä»€éº¼é›£æï¼Ÿ
1. **ç„¡æ³•å¿«é€Ÿè¿­ä»£**: æ¯å€‹å°æ”¹å‹•éƒ½è¦ç­‰å¾…å®Œæ•´çš„å»ºç½®éç¨‹
2. **éŒ¯èª¤å›é¥‹å»¶é²**: éœ€è¦æŸ¥çœ‹å»ºç½®æ—¥èªŒæ‰çŸ¥é“å…·é«”éŒ¯èª¤
3. **å¿…é ˆä½¿ç”¨å»ºç½®æ¨¡å¼**: Zeabur ç„¡æ³•ä½¿ç”¨é–‹ç™¼æ¨¡å¼ï¼Œå¿…é ˆé€šéå»ºç½®æª¢æŸ¥

---

### 5. **Supabase å‹åˆ¥å®šç¾©ç¶­è­·å›°é›£** âš ï¸ **ä¸­ç­‰**

#### å•é¡Œæè¿°
- `types/supabase.ts` æ˜¯æ‰‹å‹•ç¶­è­·çš„
- ç•¶è³‡æ–™è¡¨çµæ§‹æ”¹è®Šæ™‚ï¼Œéœ€è¦æ‰‹å‹•æ›´æ–°å‹åˆ¥å®šç¾©
- å®¹æ˜“å‡ºç¾å‹åˆ¥å®šç¾©èˆ‡å¯¦éš›è³‡æ–™åº«çµæ§‹ä¸ä¸€è‡´çš„æƒ…æ³

#### ç¾ç‹€
- `Database` å‹åˆ¥åªå®šç¾©äº†éƒ¨åˆ†è³‡æ–™è¡¨ï¼ˆ`orders`ã€`products` ç­‰ï¼‰
- ç¼ºå°‘ `suiteql_tables_reference`ã€`sync_tasks` ç­‰æ–°è¡¨çš„å®Œæ•´å®šç¾©
- RPC å‡½æ•¸ï¼ˆå¦‚ `exec_sql`ï¼‰å®Œå…¨æ²’æœ‰å‹åˆ¥å®šç¾©

---

## ğŸ¯ æ ¹æœ¬åŸå› ç¸½çµ

### ğŸ”´ **ç‚ºä»€éº¼æœ¬åœ°ä¸æœƒé‡åˆ°å•é¡Œï¼Ÿ**ï¼ˆé—œéµç™¼ç¾ï¼‰

é€™æ˜¯æ•´å€‹å•é¡Œçš„**æ ¸å¿ƒå·®ç•°**ï¼š

| ç’°å¢ƒ | æ¨¡å¼ | å‹åˆ¥æª¢æŸ¥ | çµæœ |
|------|------|---------|------|
| **æœ¬åœ°é–‹ç™¼** | `npm run dev` | âš ï¸ å¯¬é¬†ï¼ˆåªè­¦å‘Šï¼‰ | âœ… **å¯ä»¥é‹è¡Œ** |
| **æœ¬åœ°å»ºç½®** | `npm run build` | âŒ åš´æ ¼ï¼ˆæœƒå¤±æ•—ï¼‰ | âš ï¸ ä¹‹å‰æœƒå¤±æ•—ï¼Œç¾åœ¨é€šéï¼ˆå·²è¨­å®š ignoreï¼‰ |
| **Zeabur éƒ¨ç½²** | `npm run build` | âŒ åš´æ ¼ï¼ˆæœƒå¤±æ•—ï¼‰ | âŒ **ä¹‹å‰ä¸€ç›´å¤±æ•—** |

**é—œéµå·®ç•°**:
- `next dev` æ¡ç”¨**å¢é‡ç·¨è­¯**ï¼Œåªç·¨è­¯ä¿®æ”¹çš„æª”æ¡ˆï¼Œå‹åˆ¥éŒ¯èª¤åªæœƒé¡¯ç¤º**è­¦å‘Š**ï¼Œä¸æœƒé˜»æ­¢é‹è¡Œ
- `next build` åŸ·è¡Œ**å®Œæ•´å‹åˆ¥æª¢æŸ¥**ï¼ˆ`tsc --noEmit`ï¼‰ï¼Œä»»ä½•éŒ¯èª¤éƒ½æœƒ**é˜»æ­¢å»ºç½®**
- Zeabur **å¿…é ˆåŸ·è¡Œå»ºç½®æ¨¡å¼**æ‰èƒ½éƒ¨ç½²ï¼Œç„¡æ³•ä½¿ç”¨é–‹ç™¼æ¨¡å¼

**çµè«–**: æœ¬åœ°é–‹ç™¼æ™‚ï¼ŒSupabase çš„å‹åˆ¥å•é¡Œä¸€ç›´å­˜åœ¨ï¼Œåªæ˜¯è¢«é–‹ç™¼æ¨¡å¼çš„å¯¬é¬†æª¢æŸ¥çµ¦éš±è—äº†ã€‚ä¸€æ—¦åŸ·è¡Œå»ºç½®ï¼Œæ‰€æœ‰å‹åˆ¥éŒ¯èª¤å°±æœƒæš´éœ²å‡ºä¾†ã€‚

---

### æœ€å¤§å•é¡Œï¼š**Supabase + TypeScript çš„å‹åˆ¥ç³»çµ±ä¸åŒ¹é…**

1. **Supabase çš„å‹åˆ¥æ¨æ–·å‡è¨­æ‰€æœ‰è³‡æ–™è¡¨éƒ½å·²å®Œæ•´å®šç¾©åœ¨ `Database` å‹åˆ¥ä¸­**
2. **å¯¦éš›å°ˆæ¡ˆä¸­æœ‰å¤§é‡å‹•æ…‹è¡¨åå’Œæœªå®šç¾©çš„è¡¨**
3. **TypeScript strict mode ç„¡æ³•å®¹å¿é€™ç¨®ä¸åŒ¹é…**
4. **å°è‡´æ•´å€‹æŸ¥è©¢éˆè¢«æ¨æ–·ç‚º `never`ï¼Œé€²è€Œæ‰€æœ‰æ“ä½œéƒ½å¤±æ•—**
5. **é–‹ç™¼æ¨¡å¼éš±è—äº†é€™äº›å•é¡Œï¼Œå»ºç½®æ¨¡å¼æ‰æœƒæš´éœ²**

### æ¬¡è¦å•é¡Œï¼š**ç¼ºä¹æ¼¸é€²å¼å‹åˆ¥é·ç§»ç­–ç•¥**

1. **å°ˆæ¡ˆè¦æ¨¡å¤§**ï¼ˆ42 å€‹æª”æ¡ˆä½¿ç”¨ Supabaseï¼‰
2. **å‹åˆ¥å•é¡Œé›†ä¸­çˆ†ç™¼**ï¼Œç„¡æ³•é€æ­¥ä¿®å¾©
3. **ç¼ºä¹è‡ªå‹•åŒ–å·¥å…·**ä¾†ç”Ÿæˆå’Œç¶­è­·å‹åˆ¥å®šç¾©
4. **é–‹ç™¼èˆ‡å»ºç½®ç’°å¢ƒä¸ä¸€è‡´**ï¼Œå°è‡´å•é¡Œåœ¨éƒ¨ç½²æ™‚æ‰ç™¼ç¾

---

## ğŸ’¡ æ¶æ§‹æ”¹é€²å»ºè­°

### ğŸš€ çŸ­æœŸæ–¹æ¡ˆï¼ˆç«‹å³åŸ·è¡Œï¼‰

#### 1. **ä½¿ç”¨ Supabase CLI è‡ªå‹•ç”Ÿæˆå‹åˆ¥å®šç¾©**
```bash
# å®‰è£ Supabase CLI
npm install supabase --save-dev

# ç”Ÿæˆå‹åˆ¥å®šç¾©
npx supabase gen types typescript --project-id YOUR_PROJECT_ID > types/supabase.ts
```

**å„ªé»**:
- è‡ªå‹•åŒæ­¥è³‡æ–™åº«çµæ§‹
- æ¸›å°‘æ‰‹å‹•ç¶­è­·éŒ¯èª¤
- åŒ…å«æ‰€æœ‰è¡¨å’Œ RPC å‡½æ•¸çš„å‹åˆ¥

#### 2. **å»ºç«‹å‹åˆ¥è¼”åŠ©å·¥å…·å±¤**
```typescript
// lib/supabase/typed-client.ts
import { createClient } from './client';
import type { Database } from '@/types/supabase';

// å»ºç«‹å‹åˆ¥å®‰å…¨çš„å®¢æˆ¶ç«¯åŒ…è£
export function typedUpdate<T extends keyof Database['public']['Tables']>(
  table: T,
  data: Database['public']['Tables'][T]['Update']
) {
  const supabase = createClient();
  // @ts-expect-error - å·²åœ¨å‡½æ•¸å±¤ç´šè™•ç†å‹åˆ¥
  return supabase.from(table).update(data);
}
```

#### 3. **åˆ†éšæ®µå•Ÿç”¨å‹åˆ¥æª¢æŸ¥**
```javascript
// next.config.js
typescript: {
  ignoreBuildErrors: process.env.CI !== 'true', // æœ¬åœ°é–‹ç™¼æ™‚å¿½ç•¥ï¼ŒCI æ™‚å•Ÿç”¨
}
```

---

### ğŸ›ï¸ ä¸­æœŸæ–¹æ¡ˆï¼ˆ1-2 é€±å…§ï¼‰

#### 1. **é‡æ§‹ Supabase å®¢æˆ¶ç«¯ä½¿ç”¨æ¨¡å¼**

**å•é¡Œ**: ç›®å‰æœ‰ 3 ç¨®ä¸åŒçš„å®¢æˆ¶ç«¯å‰µå»ºæ–¹å¼ï¼š
- `lib/supabase/client.ts` - ç€è¦½å™¨ç«¯
- `lib/supabase/server.ts` - ä¼ºæœå™¨ç«¯
- `lib/supabase/admin.ts` - ç®¡ç†ç«¯

**å»ºè­°**: çµ±ä¸€ä½¿ç”¨å–®ä¸€å·¥å» å‡½æ•¸ï¼Œè‡ªå‹•åˆ¤æ–·åŸ·è¡Œç’°å¢ƒ

#### 2. **å»ºç«‹ API å±¤æŠ½è±¡**

**å•é¡Œ**: API routes ç›´æ¥ä½¿ç”¨ Supabaseï¼Œå°è‡´å‹åˆ¥å•é¡Œæ“´æ•£

**å»ºè­°**: å»ºç«‹æ¥­å‹™é‚è¼¯å±¤ï¼Œå°‡ Supabase æ“ä½œå°è£èµ·ä¾†
```
lib/
  services/
    suiteql-service.ts    # SuiteQL ç›¸é—œæ“ä½œ
    sync-service.ts       # åŒæ­¥ç›¸é—œæ“ä½œ
    table-service.ts      # è¡¨æ ¼ç®¡ç†æ“ä½œ
```

#### 3. **ä½¿ç”¨ Zod é€²è¡Œé‹è¡Œæ™‚é©—è­‰**

**å•é¡Œ**: TypeScript åªæä¾›ç·¨è­¯æ™‚å‹åˆ¥æª¢æŸ¥

**å»ºè­°**: çµåˆ Zod schema é€²è¡Œé‹è¡Œæ™‚é©—è­‰
```typescript
import { z } from 'zod';

const SuiteQLTableSchema = z.object({
  record_type: z.string(),
  suiteql_table: z.string(),
  // ...
});

// åœ¨å¾ Supabase å–å¾—è³‡æ–™å¾Œç«‹å³é©—è­‰
const validated = SuiteQLTableSchema.parse(data);
```

---

### ğŸ–ï¸ é•·æœŸæ–¹æ¡ˆï¼ˆ1 å€‹æœˆå…§ï¼‰

#### 1. **è€ƒæ…®é·ç§»åˆ° Prisma æˆ– Drizzle ORM**

**åŸå› **:
- æ›´å¥½çš„ TypeScript æ”¯æ´
- è‡ªå‹•ç”Ÿæˆå‹åˆ¥å®šç¾©
- æ›´æ¸…æ™°çš„æŸ¥è©¢èªæ³•

**é·ç§»æˆæœ¬**: ä¸­ç­‰ï¼ˆéœ€è¦é‡å¯«è³‡æ–™è¨ªå•å±¤ï¼‰

#### 2. **å¯¦ä½œ GraphQL API å±¤**

**åŸå› **:
- å‹åˆ¥å®‰å…¨çš„è‡ªå‹•ç”Ÿæˆ
- æ¸›å°‘å‰å¾Œç«¯å‹åˆ¥ä¸ä¸€è‡´
- æ›´å¥½çš„ API æ–‡ä»¶

**é·ç§»æˆæœ¬**: é«˜ï¼ˆéœ€è¦é‡æ§‹æ•´å€‹ APIï¼‰

#### 3. **åˆ†é›¢å‹åˆ¥æª¢æŸ¥å’Œå»ºç½®æµç¨‹**

**å»ºè­°**: 
- åœ¨ pre-commit hook ä¸­åŸ·è¡Œå‹åˆ¥æª¢æŸ¥
- å»ºç½®æ™‚åªæª¢æŸ¥é—œéµæª”æ¡ˆ
- ä½¿ç”¨ lint-staged æ¼¸é€²å¼ä¿®å¾©

---

## ğŸ“Š å„ç’°ç¯€å›°é›£åº¦è©•ä¼°

### Supabase å‹åˆ¥å•é¡Œ â­â­â­â­â­ (æœ€é›£)
- **å›°é›£é»**: å‹åˆ¥ç³»çµ±è¨­è¨ˆå‡è¨­èˆ‡å¯¦éš›ä½¿ç”¨å ´æ™¯ä¸åŒ¹é…
- **å½±éŸ¿**: 70% çš„éƒ¨ç½²å¤±æ•—
- **å»ºè­°**: å„ªå…ˆä½¿ç”¨è‡ªå‹•ç”Ÿæˆå‹åˆ¥å®šç¾©å·¥å…·

### TypeScript Strict Mode â­â­â­â­ (å¾ˆé›£)
- **å›°é›£é»**: åš´æ ¼å‹åˆ¥æª¢æŸ¥å°è‡´ç„¡æ³•å®¹å¿ä»»ä½•ä¸åŒ¹é…
- **å½±éŸ¿**: 20% çš„éƒ¨ç½²å¤±æ•—
- **å»ºè­°**: åˆ†éšæ®µå•Ÿç”¨ï¼Œæˆ–ä½¿ç”¨æ›´å¯¬é¬†çš„æª¢æŸ¥è¦å‰‡

### Zeabur éƒ¨ç½²ç’°å¢ƒ â­â­â­ (ä¸­ç­‰)
- **å›°é›£é»**: ç„¡æ³•è‡ªè¨‚å»ºç½®æµç¨‹ï¼Œå¿…é ˆç¬¦åˆ Next.js é è¨­è¡Œç‚º
- **å½±éŸ¿**: 10% çš„éƒ¨ç½²å¤±æ•—ï¼ˆä¸»è¦æ˜¯ç’°å¢ƒå·®ç•°ï¼‰
- **å»ºè­°**: è€ƒæ…®ä½¿ç”¨ GitHub Actions é€²è¡Œå»ºç½®ï¼Œç„¶å¾Œéƒ¨ç½²åˆ° Zeabur

### Git/GitHub æµç¨‹ â­ (ç°¡å–®)
- **å›°é›£é»**: ç„¡æ˜é¡¯å•é¡Œ
- **å»ºè­°**: ä¿æŒç¾æœ‰æµç¨‹

---

## ğŸ¯ å„ªå…ˆæ”¹é€²é …ç›®ï¼ˆå»ºè­°åŸ·è¡Œé †åºï¼‰

### ğŸ”´ æœ€é«˜å„ªå…ˆç´šï¼ˆæœ¬é€±å…§ï¼‰
1. âœ… **ä½¿ç”¨ Supabase CLI è‡ªå‹•ç”Ÿæˆå‹åˆ¥å®šç¾©**
2. âœ… **æ›´æ–° `types/supabase.ts` åŒ…å«æ‰€æœ‰è³‡æ–™è¡¨**
3. âœ… **å»ºç«‹ CI/CD ä¸­çš„å‹åˆ¥æª¢æŸ¥è…³æœ¬**ï¼ˆå¯é¸ï¼‰

### ğŸŸ¡ é«˜å„ªå…ˆç´šï¼ˆ2 é€±å…§ï¼‰
4. âœ… **å»ºç«‹ API æœå‹™å±¤**ï¼Œå°è£ Supabase æ“ä½œ
5. âœ… **å¯¦ä½œ Zod schema é©—è­‰**
6. âœ… **çµ±ä¸€ Supabase å®¢æˆ¶ç«¯å‰µå»ºæ–¹å¼**

### ğŸŸ¢ ä¸­å„ªå…ˆç´šï¼ˆ1 å€‹æœˆå…§ï¼‰
7. âœ… **è€ƒæ…®å¼•å…¥ Prisma/Drizzle ORM**ï¼ˆè©•ä¼°æˆæœ¬æ•ˆç›Šï¼‰
8. âœ… **å»ºç«‹è‡ªå‹•åŒ–æ¸¬è©¦**ï¼ˆåŒ…å«å‹åˆ¥æª¢æŸ¥ï¼‰
9. âœ… **é‡æ§‹ Edge Functions**ï¼ˆåˆ†é›¢ Deno ç’°å¢ƒï¼‰

---

## ğŸ’¬ çµè«–

### æœ€å¤§å•é¡Œï¼š**Supabase å‹åˆ¥ç³»çµ±è¨­è¨ˆç¼ºé™·**

æœ€æ ¸å¿ƒçš„å•é¡Œæ˜¯ **Supabase çš„ TypeScript å‹åˆ¥ç³»çµ±èˆ‡å¯¦éš›ä½¿ç”¨å ´æ™¯çš„ä¸åŒ¹é…**ã€‚Supabase å‡è¨­æ‰€æœ‰è³‡æ–™è¡¨éƒ½å·²å®Œæ•´å®šç¾©åœ¨ `Database` å‹åˆ¥ä¸­ï¼Œä½†å¯¦éš›å°ˆæ¡ˆæœ‰å¤§é‡å‹•æ…‹è¡¨åå’Œæœªå®šç¾©çš„è¡¨ï¼Œå°è‡´æ•´å€‹æŸ¥è©¢éˆè¢«æ¨æ–·ç‚º `never`ã€‚

### å»ºè­°çš„è§£æ±ºè·¯å¾‘

1. **çŸ­æœŸ** (æœ¬é€±): ä½¿ç”¨ Supabase CLI è‡ªå‹•ç”Ÿæˆå‹åˆ¥å®šç¾©ï¼Œæ›´æ–° `types/supabase.ts`
2. **ä¸­æœŸ** (2 é€±): å»ºç«‹ API æœå‹™å±¤ï¼Œå°è£ Supabase æ“ä½œï¼Œæ¸›å°‘ç›´æ¥ä½¿ç”¨
3. **é•·æœŸ** (1 å€‹æœˆ): è©•ä¼°é·ç§»åˆ° Prisma æˆ– Drizzle ORM çš„å¯èƒ½æ€§

### æ¶æ§‹èª¿æ•´å»ºè­°

**ç›®å‰æ¶æ§‹**: 
```
å‰ç«¯ â†’ API Routes â†’ Supabase (ç›´æ¥èª¿ç”¨)
```

**å»ºè­°æ¶æ§‹**:
```
å‰ç«¯ â†’ API Routes â†’ Service Layer â†’ Supabase (å°è£æ“ä½œ)
                â†“
         Type Validation (Zod)
```

é€™æ¨£çš„æ¶æ§‹å¯ä»¥ï¼š
- æ¸›å°‘å‹åˆ¥å•é¡Œçš„æ“´æ•£
- æä¾›æ›´å¥½çš„éŒ¯èª¤è™•ç†
- æ›´å®¹æ˜“æ¸¬è©¦å’Œç¶­è­·

---

## ğŸ“ é™„éŒ„ï¼šå¤±æ•—è¨˜éŒ„æ‘˜è¦

### ä¸»è¦éŒ¯èª¤é¡å‹çµ±è¨ˆ
- `Type 'any' is not assignable to type 'never'`: 15+ æ¬¡
- `Property 'xxx' does not exist on type 'never'`: 10+ æ¬¡
- `Unused '@ts-expect-error' directive`: 5+ æ¬¡
- `useSearchParams() should be wrapped in suspense`: 1 æ¬¡
- `OAuth is not callable`: 1 æ¬¡

### ä¿®å¾©å˜—è©¦è¨˜éŒ„
- å˜—è©¦ä½¿ç”¨ `as any`: âŒ å¤±æ•—ï¼ˆå‹åˆ¥æ¨æ–·ä»ç‚º neverï¼‰
- å˜—è©¦ä½¿ç”¨ `@ts-expect-error`: âš ï¸ éƒ¨åˆ†æˆåŠŸï¼ˆéœ€è¦æ”¾åœ¨æ­£ç¢ºä½ç½®ï¼‰
- å˜—è©¦æš«æ™‚ç¦ç”¨æª¢æŸ¥: âœ… æˆåŠŸï¼ˆæœ€çµ‚æ–¹æ¡ˆï¼‰

---

**å ±å‘Šç”Ÿæˆæ™‚é–“**: 2025-11-02  
**åˆ†æç¯„åœ**: 2025-11-02 çš„æ‰€æœ‰éƒ¨ç½²å˜—è©¦  
**å ±å‘Šç‰ˆæœ¬**: 1.0

